<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Yönetici Paneli | SAX AUDIO</title>
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <style>
    body { background-color: #f8f9fa; }
    .sidebar { min-height: 100vh; background-color: #343a40; color: white; }
    .sidebar a { color: #adb5bd; text-decoration: none; display: block; padding: 10px 20px; }
    .sidebar a:hover, .sidebar a.active { background-color: #495057; color: white; }
  </style>
</head>
<body>

  <div class="container-fluid">
    <div class="row">
      <div class="col-md-3 col-lg-2 sidebar pt-3">
        <h3 class="text-center mb-4">SAX ADMIN</h3>
        <a href="#" class="active"><i class="bi bi-megaphone"></i> Duyurular</a>
        <a href="index.html" class="text-danger mt-5"><i class="bi bi-box-arrow-left"></i> Siteye Dön</a>
      </div>

      <div class="col-md-9 col-lg-10 pt-4 px-4">
        <h2 class="mb-4">Duyuru Yönetimi</h2>

        <div class="card shadow-sm mb-5">
          <div class="card-header bg-primary text-white">
            <i class="bi bi-plus-circle"></i> Yeni Duyuru Yayınla
          </div>
          <div class="card-body">
            <form id="announcementForm">
              <div class="mb-3">
                <label class="form-label">Duyuru Başlığı</label>
                <input type="text" id="title" class="form-control" placeholder="Örn: Yaz Kampanyası" required>
              </div>
              <div class="mb-3">
                <label class="form-label">İçerik Detayı</label>
                <textarea id="content" class="form-control" rows="3" required></textarea>
              </div>
              <div class="row mb-3">
                 <div class="col-md-6">
                    <label class="form-label">Tarih</label>
                    <input type="date" id="date" class="form-control" required>
                 </div>
                 <div class="col-md-6">
                    <label class="form-label">Etiket (Badge)</label>
                    <select id="badge" class="form-select">
                        <option value="Kampanya">Kampanya</option>
                        <option value="Duyuru">Duyuru</option>
                        <option value="Haber">Haber</option>
                    </select>
                 </div>
              </div>
              <button type="submit" class="btn btn-success"><i class="bi bi-save"></i> Yayınla</button>
            </form>
          </div>
        </div>

        <div class="card shadow-sm">
          <div class="card-header">
            <i class="bi bi-list-ul"></i> Yayındaki Duyurular
          </div>
          <div class="card-body">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>Tarih</th>
                  <th>Başlık</th>
                  <th>Etiket</th>
                  <th>İşlem</th>
                </tr>
              </thead>
              <tbody id="adminList">
                </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // 1. Sayfa Yüklendiğinde Listeyi Getir
    document.addEventListener('DOMContentLoaded', loadAdminList);

    // 2. Form Gönderildiğinde Kaydet
    document.getElementById('announcementForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const newAnnouncement = {
            id: Date.now(), // Benzersiz ID
            title: document.getElementById('title').value,
            content: document.getElementById('content').value,
            date: document.getElementById('date').value,
            badge: document.getElementById('badge').value
        };

        // Mevcut listeyi çek, yeniyi ekle, kaydet
        let announcements = JSON.parse(localStorage.getItem('announcements')) || [];
        announcements.unshift(newAnnouncement); // En başa ekle
        localStorage.setItem('announcements', JSON.stringify(announcements));

        alert('Duyuru başarıyla yayınlandı!');
        document.getElementById('announcementForm').reset();
        loadAdminList(); // Listeyi güncelle
    });

    // 3. Listeyi Ekrana Basma Fonksiyonu
    function loadAdminList() {
        let announcements = JSON.parse(localStorage.getItem('announcements')) || [];
        const listBody = document.getElementById('adminList');
        listBody.innerHTML = '';

        announcements.forEach(item => {
            let row = `<tr>
                <td>${item.date}</td>
                <td>${item.title}</td>
                <td><span class="badge bg-info">${item.badge}</span></td>
                <td><button class="btn btn-sm btn-danger" onclick="deleteAnnouncement(${item.id})">Sil</button></td>
            </tr>`;
            listBody.innerHTML += row;
        });
    }

    // 4. Silme Fonksiyonu
    function deleteAnnouncement(id) {
        if(confirm('Bu duyuruyu silmek istediğinize emin misiniz?')) {
            let announcements = JSON.parse(localStorage.getItem('announcements')) || [];
            // ID'si eşleşmeyenleri tut, eşleşeni at (Filtreleme)
            announcements = announcements.filter(item => item.id !== id);
            localStorage.setItem('announcements', JSON.stringify(announcements));
            loadAdminList();
        }
    }
  </script>
</body>
</html>